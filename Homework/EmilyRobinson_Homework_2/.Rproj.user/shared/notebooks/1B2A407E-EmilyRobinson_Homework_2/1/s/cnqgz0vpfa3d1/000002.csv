"0","logLikeSurvival <- function(theta, der = 0, X, y, w){"
"0","  "
"0","  p     <- length(theta)"
"0","  alpha <- theta[1]"
"0","  beta  <- theta[2:3]"
"0","  "
"0","  value <- sum(w*log(y^alpha*exp(X%*%beta)) - y^alpha*exp(X%*%beta) + w*log(alpha/y))"
"0","  if(der == 0) return(value)"
"0","  "
"0","  der1      <- matrix(NA, nrow = 3, ncol = 1)  "
"0","  der1[1]   <- sum(w*log(y) - y^alpha*log(y)*exp(X%*%beta) + w/alpha)"
"0","  for (j in 2:p){"
"0","    der1[j]  <- sum(w*X[,j-1] - y^alpha*X[,j-1]*exp(X%*%beta))"
"0","  }"
"0","  if(der ==1) return(list(value = value, der1 = der1))"
"0","  "
"0","  der2      <- matrix(NA, nrow = 3, ncol = 3)"
"0","  der2[1,1] <- sum(-y^alpha*log(y)^2*exp(X%*%beta)-w/alpha^2)"
"0","  for (j in 2:p){"
"0","    der2[1,j] <- der2[j,1] <- sum(-y^alpha*X[,j-1]*log(y)*exp(X%*%beta))"
"0","    for (k in 2:p){"
"0","      der2[j,k] = der2[k,j] = sum(-y^alpha*X[,j-1]*exp(X%*%beta))"
"0","    }"
"0","  }"
"0","  return(list(value = value, der1 = der1, der2 = der2))"
"0","  "
"0","}"
